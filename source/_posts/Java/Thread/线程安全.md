---
title: 线程安全
date: 
tags:
- Java
---
<!-- TOC -->

- [synchronized](#synchronized)
- [volatile](#volatile)

<!-- /TOC -->

# synchronized

对于普通变量,方法所加的锁都是对象锁,一个对象一把锁,互不影响
对于静态变量,方法所加的锁都是类锁,此类的所有对象共用一把锁

局部变量不会发生线程安全问题.

锁重入:自己可以获取自己的内部锁.
当线程请求一个由其它线程持有的对象锁时，该线程会阻塞，而当线程请求由自己持有的对象锁时，如果该锁是重入锁,请求就会成功，否则阻塞

# volatile

重排序优化
JVM为了优化指令，提高程序运行效率，在不影响单线程程序执行结果的前提下，尽可能地提高并行度,因此多线程下的优化会给开发者带来问题,
可能导致代码的执行顺序可能不是书写的顺序,对变量的修改无法告知所有操作该变量的其他线程.
