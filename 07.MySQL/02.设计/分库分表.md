<details>
<summary>点击展开目录</summary>
<!-- TOC -->

- [分表](#分表)
    - [水平切分](#水平切分)
    - [垂直切分](#垂直切分)
    - [分表的问题](#分表的问题)
- [分库](#分库)
- [参考](#参考)

<!-- /TOC -->
</details>


## 分表

解决单表数据量过大带来的查询效率下降的问题

### 水平切分

1. 把一个表的数据分到多个表中, 每个表的结构相同, 能够提高查询性能
2. 自增主键可能会出现冲突, 除非主键带有唯一性的意义
3. 由于数据仍然处于同一个库中, 库级别仍有IO瓶颈

分表策略:

* 随机切分: hash, mod等基于一定的策略决定某条数据存储在那个子表中
* 连续切分: 将一定量连续数据放在一张表表中, 如某些数据使用频繁, 就会出现热点表, 违背了分表目的

### 垂直切分

1. 把一个表的字段分到多个表中, 每个表的字段不同
2. 分开的表中数据通过主键等关联

### 分表的问题

1. 表关联: 需要进行表关联时, 处理起来会麻烦, 不能简单的将所有子表进行join
2. 分布式事务: 数据一致性
3. 数据id问题: 如MySQL不能使用自增的id, 而应该使用全局唯一id, 如UUID等

## 分库

提高数据库并发访问能力, 主要是写操作

水平分:

适用于单表中数据量极大的场景, 被分成的表处于不同的库中

垂直分:

适用于单库中表的数量较多的场景, 如把一部分表单独分到另外库中

以上水平垂直本质是相同的

优点:

* 实现简单
* 存在跨库join查询问题, 无法解决单表数据量大的问题
* 事务问题, 如一个业务操作写了多个库的表, 如何保证事务的特性

**解决跨库join的一种方案**

常被join的表在每个库中都存留一份.但要求这些表很少被修改

表中保存"多余"的字段, 避免通过join去其他表获取该字段, 是一种空间换性能的方案

## 参考

https://www.cnblogs.com/wade-luffy/p/6096578.html
https://www.infoq.cn/article/key-steps-and-likely-problems-of-split-table
https://tech.meituan.com/2016/11/18/dianping-order-db-sharding.html

